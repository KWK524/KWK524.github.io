<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FGIP OJT Dashboard</title>
    <style>
        :root {
            --primary-blue: #007bff;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --accent-red: #d9534f;
            --work-green: #28a745;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        .container {
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 24px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
            text-align: center;
            width: 95%;
            max-width: 550px;
        }

        .header-title {
            color: var(--primary-blue);
            font-size: 1.6rem;
            font-weight: 900;
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }

        .today-date {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.2rem;
            color: #111;
        }

        .current-time {
            font-size: 1.4rem;
            color: #444;
            margin-bottom: 1.5rem;
            font-family: 'Cascadia Code', 'Courier New', monospace;
        }

        .period-info {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 1.5rem;
        }

        /* Gauge Commons */
        .gauge-container {
            background: #e9ecef;
            border-radius: 50px;
            height: 20px;
            width: 100%;
            overflow: hidden;
            margin-bottom: 0.6rem;
        }
        .gauge-fill {
            height: 100%;
            width: 0%;
            transition: width 0.05s linear;
        }
        .gauge-text {
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Cascadia Code', 'Courier New', monospace;
            margin-bottom: 1.5rem;
        }

        /* Total Gauge */
        .total-fill { background: linear-gradient(90deg, #007bff, #00c6ff); }
        .total-text { color: var(--primary-blue); }

        /* Daily Gauge Section */
        #daily-section {
            display: none;
            margin-top: 1rem;
            padding: 1.2rem;
            background: #f0fff4;
            border-radius: 16px;
            border: 1px solid #c6f6d5;
        }
        .daily-label {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--work-green);
            margin-bottom: 0.5rem;
            display: block;
        }
        .daily-fill { background: linear-gradient(90deg, #28a745, #85e085); }
        .daily-text { color: var(--work-green); margin-bottom: 0; }

        /* Stats Card */
        .stats-grid {
            display: grid;
            gap: 1rem;
            margin-top: 1.5rem;
            border-top: 1px solid #eee;
            padding-top: 1.5rem;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 1rem 1.2rem;
            border-radius: 16px;
            text-align: left;
        }
        .stat-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.4rem;
            display: block;
        }
        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #222;
        }
        .highlight { color: var(--accent-red); }
    </style>
</head>
<body>

<div class="container">
    <div class="header-title">FGIP OJT</div>
    <div id="today-date" class="today-date"></div>
    <div id="current-time" class="current-time"></div>
    
    <div class="period-info">
        ÌååÍ≤¨ ÏãúÏûë: 2025.08.31 | ÌååÍ≤¨ Ï¢ÖÎ£å: 2026.02.14
    </div>

    <div class="gauge-container">
        <div id="total-fill" class="gauge-fill total-fill"></div>
    </div>
    <div id="total-percent" class="gauge-text total-text">0.00000000%</div>

    <div id="daily-section">
        <span class="daily-label">üîã Ïò§ÎäòÏùò ÏóÖÎ¨¥ ÏßÑÌñâÎèÑ</span>
        <div class="gauge-container">
            <div id="daily-fill" class="gauge-fill daily-fill"></div>
        </div>
        <div id="daily-remain-text" class="gauge-text daily-text">00:00:00</div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-label">üìÖ ÎÇ®ÏùÄ Í∑ºÎ¨¥Ïùº</span>
            <span id="remain-days" class="stat-value">0Ïùº</span>
        </div>
        <div class="stat-card">
            <span class="stat-label">‚è∞ Ï¥ù ÎÇ®ÏùÄ ÏàúÏàò ÏóÖÎ¨¥ ÏãúÍ∞Ñ</span>
            <span id="remain-work-hours" class="stat-value highlight">0ÏãúÍ∞Ñ 0Î∂Ñ 0Ï¥à</span>
        </div>
    </div>
</div>

<script>
    const START_DATE = new Date('2025-08-31T00:00:00+03:00');
    const END_DATE = new Date('2026-02-14T15:00:00+03:00'); 

    function getGMT3Now() {
        const now = new Date();
        return new Date(now.getTime() + (now.getTimezoneOffset() * 60000) + (3 * 3600000));
    }

    function update() {
        const now = getGMT3Now();

        // 1. Í∏∞Î≥∏ ÎÇ†Ïßú/ÏãúÍ∞Ñ
        const dateOpt = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
        document.getElementById('today-date').innerText = now.toLocaleDateString('ko-KR', dateOpt);
        document.getElementById('current-time').innerText = 
            now.toLocaleTimeString('ko-KR', { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' }) + " (GMT+3)";

        // 2. Ï†ÑÏ≤¥ ÏßÑÌñâÎ•† (ÏÜåÏàòÏ†ê 8ÏûêÎ¶¨)
        const totalMs = END_DATE - START_DATE;
        const elapsedMs = now - START_DATE;
        let progress = Math.max(0, Math.min(100, (elapsedMs / totalMs) * 100));
        document.getElementById('total-fill').style.width = progress + "%";
        document.getElementById('total-percent').innerText = progress.toFixed(8) + "% Í≤ΩÍ≥º";

        // 3. Î≥ÄÏàò Ï¥àÍ∏∞Ìôî
        let remainDays = 0;
        let totalWorkSec = 0;
        let isWorkingNow = false;
        let dailyRemainingSec = 0;
        let dailyProgress = 0;

        let iter = new Date(now);
        iter.setHours(0,0,0,0);
        
        let tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0,0,0,0);

        // Ï¢ÖÎ£åÏùºÍπåÏßÄ ÏàúÌöå
        let scan = new Date(iter);
        while (scan <= END_DATE) {
            const day = scan.getDay(); // 0:Ïùº, 4:Î™©, 5:Í∏à, 6:ÌÜ†
            const isLastDay = scan.toDateString() === END_DATE.toDateString();
            const isShortDay = (day === 4 || isLastDay); // Î™©ÏöîÏùº ÎòêÎäî ÎßàÏßÄÎßâ ÎÇ†(2/14)

            if (day !== 5) {
                // [ÎÇ®ÏùÄ Í∑ºÎ¨¥Ïùº] Ïò§Îäò Ï†úÏô∏ ÎÇ¥ÏùºÎ∂ÄÌÑ∞
                if (scan >= tomorrow) remainDays++;

                // [ÏóÖÎ¨¥ ÏãúÍ∞Ñ Í≥ÑÏÇ∞]
                const shifts = [
                    { s: 6, e: 12 },
                    { s: 13, e: isShortDay ? 15 : 17 }
                ];

                const dayStart = new Date(scan).setHours(6, 0, 0, 0);
                const dayEnd = new Date(scan).setHours(isShortDay ? 15 : 17, 0, 0, 0);

                shifts.forEach(shift => {
                    let sTime = new Date(scan).setHours(shift.s, 0, 0, 0);
                    let eTime = new Date(scan).setHours(shift.e, 0, 0, 0);
                    let effectiveStart = Math.max(sTime, now.getTime());
                    if (effectiveStart < eTime) {
                        totalWorkSec += (eTime - effectiveStart) / 1000;
                    }
                });

                // [Ïò§ÎäòÏùò Í∑ºÎ¨¥ÏßÑÌñâÎ•† Î°úÏßÅ]
                if (scan.toDateString() === now.toDateString()) {
                    if (now.getTime() >= dayStart && now.getTime() < dayEnd) {
                        isWorkingNow = true;
                        dailyProgress = ((now.getTime() - dayStart) / (dayEnd - dayStart)) * 100;
                        dailyRemainingSec = Math.max(0, (dayEnd - now.getTime()) / 1000);
                    }
                }
            }
            scan.setDate(scan.getDate() + 1);
            scan.setHours(0,0,0,0);
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏: ÎÇ®ÏùÄ Í∑ºÎ¨¥ Ï†ïÎ≥¥
        document.getElementById('remain-days').innerText = remainDays + "Ïùº";
        
        const h = Math.floor(totalWorkSec / 3600);
        const m = Math.floor((totalWorkSec % 3600) / 60);
        const s = Math.floor(totalWorkSec % 60);
        document.getElementById('remain-work-hours').innerText = `${h.toLocaleString()}ÏãúÍ∞Ñ ${m}Î∂Ñ ${s}Ï¥à`;

        // UI ÏóÖÎç∞Ïù¥Ìä∏: Ïò§ÎäòÏùò ÏóÖÎ¨¥ ÏÑπÏÖò
        const dailySection = document.getElementById('daily-section');
        if (isWorkingNow) {
            dailySection.style.display = 'block';
            document.getElementById('daily-fill').style.width = dailyProgress + "%";
            
            const dh = Math.floor(dailyRemainingSec / 3600);
            const dm = Math.floor((dailyRemainingSec % 3600) / 60);
            const ds = Math.floor(dailyRemainingSec % 60);
            document.getElementById('daily-remain-text').innerText = 
                `Ïò§Îäò Ìá¥Í∑ºÍπåÏßÄ ÎÇ®ÏùÄ ÏãúÍ∞Ñ: ${String(dh).padStart(2, '0')}:${String(dm).padStart(2, '0')}:${String(ds).padStart(2, '0')}`;
        } else {
            dailySection.style.display = 'none';
        }
    }

    // 50ms Ï£ºÍ∏∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ (Ï¥àÎãπ 20Ìöå)
    setInterval(update, 50);
    update();
</script>

</body>
</html>
